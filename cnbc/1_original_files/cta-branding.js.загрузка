!function(){try{var t="1.0.40",e="cta-branding",a=31,r=104,n=10,i=22,o={},s=0,l=Math.random()<.05,d=null,f=document.createElement("canvas");if("cta-test"===e){var c={};try{for(var u=window.location.href.split("?")[1].split("&"),m=0;m<u.length;m++){var v=u[m],b=v.split("=")[0],p=v.split("=")[1];c[b]=p}}catch(t){console.error("*** had issues while reading url parameters")}}function _(t){return t.offsetHeight+h(t,"margin-top",0)+h(t,"margin-bottom",0)}function g(t){var e=0;if(t.hasChildNodes())for(var a=t.childNodes,r=0;r<a.length;r++){var n=a[r];if(!n.classList.contains("video-cta-href"))e+=_(n)}return e}function h(t,e,a){var r=window.getComputedStyle(t);if(!r[e])return a||null;var n=parseInt(r[e]);return isNaN(n)?r[e]:n}o.hooks={"item-renderer":function(a,r,i){if(!d){var o,f=a.rbox;f.formatsData=f.formatsData||{},a.formatsData=a.formatsData||{},a.formatsData.sendAbTestEvent=function(a,r,n){"cta-test"===e&&console.log("cta-test",a,r,n);if(!l)return;var i={itemId:this.formatsData.itemId,rating:this.formatsData.rating,price:this.formatsData.price,text:this.formatsData.actionText,type:null!=r?r:"event",description:n,module:e,version:t,event:a,cardIndexOnPage:this.formatsData.cardIndex,index:this.formatsData.index,placement:this.formatsData.placement};window.TRCImpl.sendAbTestEvent("CTA",JSON.stringify(i)),window.TRCImpl.sendAbTestEvent(e,a)}.bind(a),a.formatsData.cardIndex=s++,a.formatsData.index=r.itemIndex,a.formatsData.placement=f.placement,a.formatsData.itemId=(r["item-id"]||r.id||"").slice(0,40);try{var u=r["cta-text"],m=r.fpr||r["cta-price"],v=r["stars-rating"];if(null==d){var b=A("disable-cta-on-custom-module",i);a.formatsData.sendAbTestEvent(b?"disable_custom":"enable_custom");var p=window.TRCImpl&&window.TRCImpl.global&&window.TRCImpl.global["disable-cta-on-custom-module"];if(a.formatsData.sendAbTestEvent(p?"disable_global":"enable_global"),p||b)return void(d=!0);d=!1}if("cta-test"===e){var _=Math.random(),D="true"===c["cta-rating"],x="true"===c["cta-always"];if("false"===c["cta-always"])return;var T=2+(D?1:0);D&&_>2/T||m||v?(u=u||"Download Today Today",v=parseFloat(v)||5*Math.random(),m=m||"4$"):(_>1/T||x)&&(u=decodeURIComponent(c["cta-text"])||u||"Learn More")}if(!u)return;if(a.formatsData.sendAbTestEvent("has_cta_text"),!function(t,e,a){if(!e.isSyndicated||e["is-in-network"])return t.formatsData.sendAbTestEvent("filtered_non_sc"),!1;if(a.options&&a.options.trcResponse&&a.options.trcResponse.nup)return t.formatsData.sendAbTestEvent("filtered_next_up"),!1;var r=!window.TRCImpl||!window.TRCImpl.global||function(t,e){if(null==t)return e;return t}(window.TRCImpl.global["enable-cta-with-description"],!0);if(e.description&&!r)return t.formatsData.sendAbTestEvent("filterd_item_with_description"),!1;var i=t.detail_order;if(i&&i.length&&"branding"===i[0])return t.formatsData.sendAbTestEvent("filterd_item_branding_before_title"),!1;if(!t.link)return t.formatsData.sendAbTestEvent("filtered_no_title"),!1;var o=t.querySelector(".video-label-box");if(!o)return t.formatsData.sendAbTestEvent("filtered_no_video_label_box"),!1;var s=o.querySelector(".branding");if(!s)return t.formatsData.sendAbTestEvent("filtered_no_branding"),!1;var l=h(s,"position");if(l&&"absolute"===l)return t.formatsData.sendAbTestEvent("filtered_branding_absolute_position_item_renderer"),!1;var d=s.querySelector(".branding-inner");if(d){var f=h(d,"position");if(f&&"absolute"===f)return t.formatsData.sendAbTestEvent("filtered_branding_inner_absolute_position"),!1}var c=s.querySelector("div.logoDiv");if(c){var u=h(c,"position");if(u&&"absolute"===u)return t.formatsData.sendAbTestEvent("filtered_branding_logo_div_inner_absolute_position"),!1}var m=t.getBoundingClientRect().width;if(m>0&&m<170)return t.formatsData.sendAbTestEvent("filtered_below_min_width"),!1;if(t.rbox.mode_name&&t.rbox.mode_name.indexOf("hero")>-1)return t.formatsData.sendAbTestEvent("filtered_item_in_hero_widget"),!1;if(t.rbox.container.querySelector(".story-widget"))return t.formatsData.sendAbTestEvent("filterd_item_in_reco_reel_story_widget"),!1;if(t.classList.contains("tbl-next-up-widget-item"))return t.formatsData.sendAbTestEvent("filterd_item_next_up"),!1;if(t.querySelector(".added-icon-svg"))return t.formatsData.sendAbTestEvent("filterd_item_branding_has_icon"),!1;var v=h(o,"height");if(v){var b=g(o);if(v+n<b)return t.formatsData.sendAbTestEvent("filtered_videoLabelBox_smaller_than_children"),!1}return!0}(a,r,i))return;if(a.formatsData.style={borderColor:A("border-color",i),color:A("title-color",i)},a.formatsData.isInheritTitleColor=A("inherit-title-color",i),a.formatsData.shouldRenderAsCTA=!0,a.formatsData.actionText=u.slice(0,15),a.formatsData.price=m,v&&(a.formatsData.rating=(o=v,Math.round(2*o)/2)),a.formatsData.isAppInstall=function(t){if(!t.formatsData.rating&&!t.formatsData.price)return!1;return!0}(a),a.formatsData.isAppInstall?a.formatsData.sendAbTestEvent("cta_app_render_candidate"):a.formatsData.sendAbTestEvent("cta_render_candidate"),f.formatsData.isInit)return;f.formatsData.isInit=!0,f.formatsData.hasCTAItem=!0,f.formatsData.isStream=function(t){return"autowidget-template-stream"===t.trc.getProperty(t.mode_name,"widget-creator-layout",t.propertiesOverride)}(f),f.formatsData.shouldAdjustAllItemsHeight=!f.formatsData.isStream&&!function(t){var e=t.getEffectiveResponsiveRule();if(e&&1===e.cells)return!0;return!1}(f)}catch(t){throw a.formatsData.sendAbTestEvent(t.message,"error",t.stack.split("\n",2)[1].trim()),t}}function A(t,e){var a=e&&e.globalTrcResponseJSON&&e.globalTrcResponseJSON.dcga&&e.globalTrcResponseJSON.dcga.pubConfigOverride;return a&&a[t]}},"list-suffix":function(t,e){if(!d){var o=e.boxes,s=!1,l=0;o.forEach(function(t){try{var a=t.rbox.formatsData;if(!a||!a.hasCTAItem)return;if(!t.formatsData.shouldRenderAsCTA&&!a.shouldAdjustAllItemsHeight)return;var i=t.querySelector(".video-label-box");if(!i)return void t.formatsData.sendAbTestEvent("filtered_no_videoLabelBox_list_suffix");var o=i.querySelector(".branding");if(o&&t.formatsData.shouldRenderAsCTA&&t.formatsData.isAppInstall&&function(t,e,a){t.formatsData.sendAbTestEvent("renderedAppInstall");var r=function(t){var e=document.createElement("span");if(e.classList.add("video-branding-flex-cta-rating"),t.formatsData.price){var a=document.createElement("span");a.innerText=t.formatsData.price,a.classList.add("video-branding-flex-cta-price-wrapper"),e.appendChild(a)}if(t.formatsData.price&&t.formatsData.rating){var r=document.createElement("span");r.classList.add("video-branding-flex-cta-oval-wrapper");var n='<svg class="cta-rating-oval"  width="3px" height="3px" viewBox="0 0 3 3" version="1.1" xmlns="http://www.w3.org/2000/svg">    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">        <g transform="translate(-172.000000, -485.000000)" fill="#666666" fill-rule="nonzero">            <circle cx="173.5" cy="486.5" r="1.5"></circle>        </g>    </g></svg>';r.insertAdjacentHTML("beforeend",n),e.appendChild(r)}if(t.formatsData.rating){for(var i=t.formatsData.cardIndex,o=document.createElement("span"),s=0;s<5;s++){var l=Math.min(Math.max(t.formatsData.rating-s,0),1),d=c(i,s,l);o.insertAdjacentHTML("beforeend",d)}o.classList.add("video-branding-flex-cta-stars-wrapper"),e.appendChild(o)}return e}(t);e.insertBefore(r,a)}(t,i,o),a.shouldAdjustAllItemsHeight&&(l=Math.max(l,u(t,i,o))),!o)return void t.formatsData.sendAbTestEvent("filtered_no_branding_list_suffix");var d=h(i,"height");if(d){var b=g(i);if(d+n<b)return void t.formatsData.sendAbTestEvent("filtered_videoLabelBox_smaller_than_children_list_suffix")}if(t.formatsData.shouldRenderAsCTA){var p=h(o,"position");if(p&&"absolute"===p)return void t.formatsData.sendAbTestEvent("filtered_branding_absolute_position_list_suffix");var _=o.querySelector("div.logoDiv");if(_){var D=h(_,"position");if(D&&"absolute"===D)return t.formatsData.sendAbTestEvent("filtered_branding_logo_div_inner_absolute_position_list_suffix"),!1}var x,T=function(t){return h(t,"width")-r}(i)||0,A=h(o,"font-weight"),w=h(o,"font-size"),y=h(o,"font-family");try{x=function(t,e,a,r,n){if(null==e||""===e)return null;if(null==r&&(null==n||""===n))return null;if(null==f)return t.formatsData.sendAbTestEvent("measureText_no_canvas"),null;var i=f.getContext("2d");if(null==i)return t.formatsData.sendAbTestEvent("measureText_no_canvas_context"),null;var o=[];if(null!=a&&o.push(a.toString()),null!=r&&o.push(r+"px"),null!=n&&o.push(n),0===o.length)return t.formatsData.sendAbTestEvent("measureText_no_font_parts"),null;var s=o.join(" ");if(null==s||""===s)return t.formatsData.sendAbTestEvent("measureText_empty_font_value"),null;i.font=s;var l=i.measureText(e);if(null==l)return t.formatsData.sendAbTestEvent("measureText_no_metrics"),null;return l.width}(t,t.video_data["branding-text"],A,w,y)||0}catch(e){return void t.formatsData.sendAbTestEvent("filtered_error_measure_text_list_suffix")}if(x>=T)return void t.formatsData.sendAbTestEvent("filtered_large_branding_width_list_suffix");if((function(t){var e=t.querySelector(".branding-inner"),a=t.querySelector(".branding-separator"),r=t.querySelector(".logoDiv"),n=e&&TRC.dom.getOuterWidth(e)||0,i=a&&TRC.dom.getOuterWidth(a)||0,o=r&&TRC.dom.getOuterWidth(r)||0;return n+i+o}(o)||0)>=T)return void t.formatsData.sendAbTestEvent("filtered_large_branding_parts_width_list_suffix");s=!0,function(t,e,a){t.formatsData.sendAbTestEvent("rendered");var r=function(t,e){var a=document.createElement("a"),r=function(t,e){var a=document.createElement("Button");return a.type="button",a.classList.add("video-cta-button","video-cta-style"),a.innerText=t.formatsData.actionText,v(e,a,"color"),v(e,a,"font-family"),a}(t,e);return a.classList.add("video-cta-href"),a.target="_blank",a.href=function(t){var e,a=t.link,r=t.rbox;if(r.shiftRedirOnclick)e=a.logger_url;else{var n=r.attachHeatMapDataToLink(a.logger_url,null);e=n}return e+="&cta=true"}(t),a.ctaButton=r,function(t,e){if(Object.keys(t.formatsData.style).forEach(function(a){t.formatsData.style[a]&&(e.style[a]=t.formatsData.style[a])}),t.formatsData.isInheritTitleColor){var a=t.querySelector(".video-title"),r=h(a,"color");r.indexOf("rgb(0, 0, 0)")<0&&(v(a,e,"color"),window.TRCImpl.sendAbTestEvent("CTA_Title_Not_Black",t.formatsData.itemId))}}(t,r),a.appendChild(r),a}(t,a);(function(t,e,a,r){var n=function(t){var e=m(t);return!e||!t.link||t.link===e}(e)?e.link:m(e);n&&n.classList.add("video-cta-style"),!e.rbox.isFeedCard&&n&&n.classList.add("non-feed-cta-item"),a&&a.classList.add("video-label-box-cta"),a&&!TRC.Browser.ie&&a.classList.add("video-label-box-cta-non-ie");var i=a.querySelectorAll(".video-label");if(i)for(var o=0;o<i.length;o++){var s=i[o];s.classList.add("video-label-flex-cta-item")}r&&function(t,e,a){if(e.classList.add("video-branding-flex-cta-item"),t.rbox.formatsData.isStream){var r=h(e,"margin-top");r?a.style.marginTop=r+1+"px":e.classList.add("video-branding-flex-cta-item-no-stream")}else e.classList.add("video-branding-flex-cta-item-no-stream");e.style.order=1}(e,r,t),a.appendChild(t)})(r,t,e,a),function(t,e){e.onclick=function(){t.formatsData.sendAbTestEvent("cta_button_clicked")}}(t,r.ctaButton)}(t,i,o),i.classList.contains("video-label-box-cta")&&function(t,e){if(t.fixResponsiveBoxTitleAndDesc(e),window.TRC.dom.on(window,"resize",function(){t.fixResponsiveBoxTitleAndDesc(e)}),e.video_data){var a=t.getDetailSpansFromLabelsBoxes("branding",e);a.length&&setTimeout(function(){for(var r=0;r<a.length;r++)t.fixBoxOverflow(a[r],e.video_data["branding-text"],!0,!0)},0)}}(e,t)}}catch(e){throw t.formatsData.sendAbTestEvent(e.message,"error",e.stack.split("\n",2)[1].trim()),e}}),s&&o.forEach(function(t){!function(t,e){var a=t.querySelector(".video-label-box");if(t.rbox.formatsData.shouldAdjustAllItemsHeight){if(e<=0)return;return void(a.style.height=e+"px")}var r=a.querySelector(".branding"),n=u(t,a,r);if(n<=0)return;a.style.height=n+"px";var i=h(a,"max-height",0);i>0&&i<n&&(a.style.maxHeight=n+"px")}(t,l)})}function c(t,e,a){return'<svg class="cta-rating-star" height="9px" version="1.1" viewBox="0 0 9 9" width="9px" xmlns="http://www.w3.org/2000/svg">    <g fill="none" fill-rule="evenodd" stroke="none" stroke-width="1">        <linearGradient id="lg'+e+"-"+t+'" x1="0" x2="1" y1="0.5" y2="0.5">            <stop offset="0" stop-color="#737373" stop-opacity="1"/>            <stop offset="'+a+'" stop-color="#737373" stop-opacity="1"/>            <stop offset="'+a+'" stop-color="#737373" stop-opacity="0.5"/>            <stop offset="1" stop-color="#737373" stop-opacity="0.5"/>        </linearGradient>        <g fill="url(#lg'+e+"-"+t+')" fill-rule="nonzero" transform="translate(-21.000000, -19.000000)">            <polygon points="25.5 26.4626165 22.7188471 28 23.25 24.7437694 21 22.4376941 24.1094235 21.9626165 25.5 19 26.8905765 21.9626165 30 22.4376941 27.75 24.7437694 28.2811529 28"></polygon>        </g>    </g></svg>'}function u(t,e,r){var n=g(e);if((!n||0===n)&&(n=h(e,"height"))<=0)return 0;if(!t.formatsData.shouldRenderAsCTA||!r)return t.rbox.formatsData.shouldAdjustAllItemsHeight?n:0;var o=t.formatsData.isAppInstall?i:0,s=_(r),l=n+o-s+Math.max(a,s);return l<=n?t.rbox.formatsData.shouldAdjustAllItemsHeight?n:0:l}function m(t){return t.querySelector(".item-label-href")}function v(t,e,a){if(e&&t){var r=h(t,a);r&&(e.style[a]=r)}}}},window.TRC.customHooks[e]=o}catch(t){window.__trcError("Error in CTA module: "+t.message)}}();
